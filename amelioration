Sub ConfigurerMiseEnPage()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    
    Application.ScreenUpdating = False ' Désactiver les mises à jour de l'écran pour accélérer l'exécution

    ' Définir la feuille de travail cible
    Set ws = ThisWorkbook.Sheets("Transposé")
    
    ' Trouver la dernière ligne des données
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' Supprimer tous les sauts de page existants
    ws.ResetAllPageBreaks
    
    ' Ajouter des sauts de page toutes les 24 lignes
    For i = 24 To lastRow Step 24
        ws.HPageBreaks.Add Before:=ws.Rows(i + 1)
    Next i
    
    ' Configurer la mise en page pour chaque feuille
    For Each ws In ThisWorkbook.Sheets
        With ws.PageSetup
            .Orientation = xlLandscape ' Mode paysage
            .PaperSize = xlPaperA4 ' Papier format A4
            .TopMargin = Application.InchesToPoints(0) ' Marges à 0
            .BottomMargin = Application.InchesToPoints(0)
            .LeftMargin = Application.InchesToPoints(0)
            .RightMargin = Application.InchesToPoints(0)
            .HeaderMargin = Application.InchesToPoints(0)
            .FooterMargin = Application.InchesToPoints(0)
            .CenterFooter = "Page &P" ' Numéro de page au centre du pied de page
            
            ' Ajuster la mise à l'échelle pour limiter aux 16 colonnes (A à P)
            .FitToPagesWide = 1
            .FitToPagesTall = False
            .Zoom = False
        End With
    Next ws

    Application.ScreenUpdating = True ' Réactiver les mises à jour de l'écran
End Sub
