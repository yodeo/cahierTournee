Sub FusionnerCellulesCase()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim startRow As Long
    
    Application.DisplayAlerts = False
    
    ' Définir la feuille de travail cible
    Set ws = ThisWorkbook.Sheets("Transposé")
    
    ' Trouver la dernière ligne des données
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' Initialiser
    startRow = 1
    
    ' Parcourir toutes les lignes
    i = 1
    While i <= lastRow
        ' Marquer le début d'un groupe
        startRow = i
        
        ' Avancer jusqu'à la prochaine cellule non vide dans la colonne A ou jusqu'à la fin
        i = i + 1
        While i <= lastRow And (IsEmpty(ws.Cells(i, 1).Value) Or ws.Cells(i, 1).Value = "")
            i = i + 1
        Wend
        
        ' Si on a trouvé au moins une ligne vide entre startRow et i
        If i > startRow + 1 Then
            ' Fusionner les cellules de startRow jusqu'à la ligne avant i
            ws.Range(ws.Cells(startRow, 1), ws.Cells(i - 1, 1)).Merge
            
            ' Centrer et formater
            With ws.Cells(startRow, 1)
                .HorizontalAlignment = xlCenter
                .VerticalAlignment = xlCenter
                .Orientation = 90 ' Texte vertical
                .Font.Bold = True
                .Interior.Color = RGB(230, 230, 230) ' Fond gris clair
            End With
        End If
        
        ' Si on est à la dernière ligne, sortir de la boucle
        If i >= lastRow Then Exit While
    Wend
    
    Application.DisplayAlerts = True
End Sub
