Sub FusionnerCellulesCase()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim startRow As Long
    
    Application.DisplayAlerts = False
    
    ' Définir la feuille de travail cible
    Set ws = ThisWorkbook.Sheets("Transposé")
    
    ' Trouver la dernière ligne des données
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' Initialiser
    i = 1
    
    ' Parcourir toutes les lignes
    While i <= lastRow
        If Not IsEmpty(ws.Cells(i, 1)) Then
            startRow = i
            
            ' Chercher la prochaine ligne non vide en colonne A
            i = i + 1
            While i <= lastRow And IsEmpty(ws.Cells(i, 1))
                i = i + 1
            Wend
            
            ' Fusionner les cellules de la colonne A pour ce bloc
            If i - 1 > startRow Then
                ws.Range(ws.Cells(startRow, 1), ws.Cells(i - 1, 1)).Merge
                
                ' Centrer et formater
                With ws.Cells(startRow, 1)
                    .HorizontalAlignment = xlCenter
                    .VerticalAlignment = xlCenter
                    .Orientation = 90 ' Texte vertical
                    .Font.Bold = True
                    .Interior.Color = RGB(230, 230, 230) ' Fond gris clair
                End With
            End If
        Else
            ' Si la cellule est vide, passer à la ligne suivante
            i = i + 1
        End If
    Wend
    
    Application.DisplayAlerts = True
End Sub
