Sub FusionnerCellulesCase()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim startRow As Long
    Dim nextNonEmptyRow As Long
    
    Application.DisplayAlerts = False
    
    ' Définir la feuille de travail cible
    Set ws = ThisWorkbook.Sheets("Transposé")
    
    ' Trouver la dernière ligne des données
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' Parcourir toutes les lignes
    i = 1
    
    Do While i <= lastRow
        ' Ignorer les cellules vides dans la colonne A
        If Not IsEmpty(ws.Cells(i, 1).Value) And ws.Cells(i, 1).Value <> "" Then
            startRow = i
            
            ' Trouver la prochaine ligne non vide dans la colonne A
            nextNonEmptyRow = i + 1
            Do While nextNonEmptyRow <= lastRow
                If Not IsEmpty(ws.Cells(nextNonEmptyRow, 1).Value) And ws.Cells(nextNonEmptyRow, 1).Value <> "" Then
                    Exit Do
                End If
                nextNonEmptyRow = nextNonEmptyRow + 1
            Loop
            
            ' Si nous avons trouvé des lignes vides à fusionner
            If nextNonEmptyRow > startRow + 1 Then
                ' Fusionner de startRow jusqu'à la ligne avant nextNonEmptyRow
                ws.Range(ws.Cells(startRow, 1), ws.Cells(nextNonEmptyRow - 1, 1)).Merge
                
                ' Centrer et formater
                With ws.Cells(startRow, 1)
                    .HorizontalAlignment = xlCenter
                    .VerticalAlignment = xlCenter
                    .Orientation = 90 ' Texte vertical
                    .Font.Bold = True
                    .Interior.Color = RGB(230, 230, 230) ' Fond gris clair
                End With
            End If
            
            ' Avancer à la prochaine cellule non vide
            i = nextNonEmptyRow
        Else
            ' Si la cellule courante est vide, passer à la suivante
            i = i + 1
        End If
    Loop
    
    Application.DisplayAlerts = True
End Sub
