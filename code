Option Explicit

Sub AjusterTaillePolice()
    Dim ws As Worksheet
    Dim cell As Range, mergedCell As Range
    Dim plageTableau As Range
    Dim largeurCell As Double, hauteurCell As Double
    Dim cellValue As String

    Set ws = ActiveSheet
    Set plageTableau = ws.Range("A1:AA43")
    
    Application.ScreenUpdating = False

    Dim ctlLabel As Object
    Set ctlLabel = CreateObject("Forms.Label.1")

    ctlLabel.Font.Name = ws.Cells(1, 1).Font.Name

    For Each cell In plageTableau
        On Error Resume Next

        ' Ignorer les lignes paires
        If cell.Row Mod 2 = 0 Then GoTo SkipCell
        
        If cell.MergeCells Then
            Set mergedCell = cell.MergeArea
            If cell.Address = mergedCell.Cells(1, 1).Address Then
                largeurCell = mergedCell.Width
                hauteurCell = mergedCell.Height
                cellValue = CStr(mergedCell.Value)
                Call AjusterTaillePoliceUnique(mergedCell, largeurCell, hauteurCell, cellValue, ctlLabel)
            End If
        Else
            If ACelluleAvecBordures(cell) Then
                largeurCell = cell.Width
                hauteurCell = cell.Height
                cellValue = CStr(cell.Value)
                Call AjusterTaillePoliceUnique(cell, largeurCell, hauteurCell, cellValue, ctlLabel)
            End If
        End If
SkipCell:
        On Error GoTo 0
    Next cell

    Application.ScreenUpdating = True
    MsgBox "Ajustement termin√© !", vbInformation
End Sub


